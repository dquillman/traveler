{% extends "base.html" %}
{% block content %}
  <div class="card" style="margin-bottom:12px; display:flex; justify-content:space-between; align-items:center;">
    <h1 style="margin:0;">Stays</h1>
    <a class="btn" href="{% url 'stays:add' %}">Add Stay</a>
  </div>

  <div class="card" style="padding:0; overflow:auto;">
    <table class="table">
      <thead>
        <tr>
          <th>Photo</th>
          <th>Park</th>
          <th>City</th>
          <th>State</th>
          <th>Check in</th>
          <th>Leave</th>
          <th># Nts</th>
          <th>Rate/nt</th>
          <th>Total</th>
          <th>Fees</th>
          <th>Rating <span class="muted" style="font-weight:normal; font-size:0.85em; opacity:0.75;">(edit to change)</span></th>
          <th>Paid?</th>
          <th>Site</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for s in stays %}
          <tr>
            <td>
              {% if s.photo %}
                <img class="thumb" src="{{ s.photo.url }}" alt="{{ s.park|default:'photo' }}"/>
              {% else %}
                &mdash;
              {% endif %}
            </td>
            <td><a href="{% url 'stays:detail' s.pk %}">{{ s.park|default:'&mdash;' }}</a></td>
            <td>{{ s.city|default:'&mdash;' }}</td>
            <td>{{ s.state|default:'&mdash;' }}</td>
            <td>{{ s.check_in|date:"Y-m-d"|default:'&mdash;' }}</td>
            <td>{{ s.leave_date|date:"Y-m-d"|default:'&mdash;' }}</td>
            <td class="num">{{ s.nights|default:0 }}</td>
            <td class="num">{{ s.price_night|default:0|floatformat:2 }}</td>
            <td class="num">{{ s.total|default:0|floatformat:2 }}</td>
            <td class="num">{{ s.fees|default:0|floatformat:2 }}</td>
            <td>
              <div aria-label="Rating" title="Edit the stay to change rating">
                {% for i in stars %}
                  <span style="display:inline-block; padding:2px 4px; margin-right:2px; color:{% if s.rating and s.rating >= i %}var(--accent){% else %}#bbb{% endif %};">&#9733;</span>
                {% endfor %}
              </div>
            </td>
            <td>{% if s.paid %}Yes{% else %}No{% endif %}</td>
            <td>{{ s.site|default:'' }}</td>
            <td><a class="btn btn-outline" href="{% url 'stays:edit' s.pk %}">Edit</a></td>
          </tr>
        {% empty %}
          <tr><td colspan="13" style="padding:16px;">No stays yet</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% endblock %}
