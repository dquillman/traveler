{% extends "base.html" %}
{% block content %}
  <div class="flex items-center justify-between mb-4">
    <h1 class="text-2xl font-semibold">Add Stay</h1>
    <a class="btn btn-primary" href="{% url 'stays:add' %}">Add Stay</a>
  </div>

  <div class="overflow-x-auto rounded-lg border border-slate-800">
    <table class="classic">
      <thead>
        <tr>
          <th>Photo</th>
          <th>Park</th>
          <th>City</th>
          <th>State</th>
          <th>Check in</th>
          <th>Leave</th>
          <th># Nts</th>
          <th>Rate/nt</th>
          <th>Total</th>
          <th>Fees</th>
          <th>Paid?</th>
          <th>Site</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for s in stays %}
          {% with nights=0 %}
            {% if s.check_in and s.leave %}
              {% with nights=s.leave|date:"U"|add:"- %d"|stringformat:"d"|add:"0" %}{% endwith %}
            {% endif %}
          {% endwith %}
          <tr>
            <td>
              {% if s.photo %}
                <img class="thumb" src="{{ s.photo.url }}" alt="photo"/>
              {% else %}
                —
              {% endif %}
            </td>
            <td><a href="{% url 'stays:detail' s.pk %}">{{ s.park|default:"—" }}</a></td>
            <td>{{ s.city|default:"—" }}</td>
            <td>{{ s.state|default:"—" }}</td>
            <td>{{ s.check_in|date:"Y-m-d"|default:"—" }}</td>
            <td>{{ s.leave|date:"Y-m-d"|default:"—" }}</td>
            <td class="num">
              {% if s.check_in and s.leave %}{{ s.leave|date:"U"|add:"-"|add:s.check_in|date:"U" }}{% else %}0{% endif %}
            </td>
            <td class="num">{{ s.rate_per_night|default:0|floatformat:2 }}</td>
            <td class="num">{{ s.total|default:0|floatformat:2 }}</td>
            <td class="num">{{ s.fees|default:0|floatformat:2 }}</td>
            <td>{% if s.paid %}Paid{% else %}No{% endif %}</td>
            <td>{{ s.site|default:"" }}</td>
            <td><a class="btn" href="{% url 'stays:edit' s.pk %}">Edit</a></td>
          </tr>
        {% empty %}
          <tr><td colspan="13"><span class="badge">No stays yet</span></td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% endblock %}
