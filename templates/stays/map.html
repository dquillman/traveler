<div style="position:sticky;top:0;background:#0f1220;border-bottom:1px solid #272b41;padding:10px 12px;z-index:9999">
  <a href="/stays/" style="margin-right:12px;color:#e8ebff;text-decoration:none">Stays</a>
  <a href="/stays/map/" style="margin-right:12px;color:#e8ebff;text-decoration:none">Map</a>
  <a href="/stays/charts/" style="margin-right:12px;color:#e8ebff;text-decoration:none">Charts</a>
  <a href="/stays/export/" style="margin-right:12px;color:#e8ebff;text-decoration:none">Export</a>
  <a href="/stays/import/" style="color:#e8ebff;text-decoration:none">Import</a>
</div>
<!doctype html><meta charset="utf-8"><title>Traveler â€¢ Map</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<style>:root{--bg:#0f1220;--card:#161a2b;--ink:#e8ebff;--muted:#9aa4d2;--line:#272b41}
body{margin:0;background:var(--bg);color:var(--ink);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto}
#map{height:calc(100vh - 24px);margin:12px;border:1px solid var(--line);border-radius:12px;box-shadow:0 8px 24px rgba(0,0,0,.25)}</style>
<div id="map"></div>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
(async function(){
  const res = await fetch("{% url 'stays:stays_map_data' %}");
  const gj = await res.json();
  const map = L.map('map').setView([39.5,-98.35], 4);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:18, attribution:'Â© OpenStreetMap'}).addTo(map);
  const markers = L.geoJSON(gj, {
    onEachFeature: (f, layer) => {
      const p = f.properties||{};
      const html = `<strong>${p.park||'Unnamed'}</strong><br>${p.city||''}, ${p.state||''}<br>Nights: ${p.nights||0}<br>Price/Night: $${p.price_per_night||0}<br><a href="/stays/${p.id}/edit/">Open / Edit</a>`;
      layer.bindPopup(html);
    }
  }).addTo(map);
  if (markers.getLayers().length) map.fitBounds(markers.getBounds(),{padding:[20,20]});
})();
</script>

